{"version":3,"sources":["file:///Users/baitengfei/code/EscapeRoom/EscapeRoomMVP/assets/Scripts/Manager/SoundManager.ts"],"names":["_decorator","Component","game","assetManager","AudioClip","AudioSource","GameData","ccclass","property","SoundManager","LastMusicName","onLoad","Instance","addPersistRootNode","node","start","PlayBGM","strName","ins","BGM_Mute","bundle","getBundle","load","err","clip","LoadResFinish","StopBGM","mBgAudioSource","stop","name","play","PlaySound","volume","Sound_Mute","LoadSoundFinish","console","log","mSoundAudio","playOneShot","InitData","SetBGM_On","SaveData_BGM","SetBGM_Off","SetSound_On","SaveData_Sound","SetSound_Off"],"mappings":"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","sourcesContent":["import { GameData } from \"../Data/GameData\";\n\nimport { _decorator, Component, sys, game, assetManager, AudioClip, AudioSource } from 'cc';\nconst { ccclass, property } = _decorator;\n\n@ccclass('SoundManager')\nexport class SoundManager extends Component {\n    public static Instance: SoundManager = null!;\n\n    @property(AudioSource)\n    mBgAudioSource:AudioSource = null!;\n\n    @property(AudioSource)\n    mSoundAudio:AudioSource = null!;\n\n    onLoad() {\n        SoundManager.Instance = this;\n        game.addPersistRootNode(this.node);\n    }\n\n    start() {\n \n    }\n\n    PlayBGM(strName:string) {\n        if (GameData.ins().BGM_Mute) {\n            return;\n        }\n        let bundle = assetManager.getBundle(\"Sound\");\n        if (bundle != null) {\n            bundle.load(strName, AudioClip, (err, clip:AudioClip) => {\n                this.LoadResFinish(clip);\n            });\n        }\n    }\n\n    StopBGM() {\n        this.LastMusicName = \"\";\n        this.mBgAudioSource.stop();\n    }\n\n    LastMusicName:string = \"\";\n    LoadResFinish (clip: AudioClip) {\n        if (this.LastMusicName == clip.name) {\n            return;\n        }\n        this.LastMusicName = clip.name;\n        this.mBgAudioSource.clip = clip;\n        this.mBgAudioSource.play();\n    }\n\n    PlaySound(strName: string, volume: number = 1) {\n        if (GameData.ins().Sound_Mute)\n        {\n            return;\n        }\n        let bundle = assetManager.getBundle(\"Sound\");\n        if (bundle != null) {   \n            bundle.load(strName, AudioClip, (err, clip:AudioClip) => {\n                this.LoadSoundFinish(clip, volume);\n            });\n        }\n        else {\n            console.log(\"找不到资源，不能播放音效\");\n        }\n    }\n\n    LoadSoundFinish(clip: AudioClip, volume: number) {\n        //clip.playOneShot(volume);\n        this.mSoundAudio.playOneShot(clip, volume);\n    }\n\n    InitData()\n    {\n        this.mBgAudioSource.volume = GameData.ins().BGM_Mute ? 0 : 0.2;\n    }\n\n    SetBGM_On() {\n        GameData.ins().BGM_Mute = false;\n        this.mBgAudioSource.volume = 0.2;\n        GameData.ins().SaveData_BGM();\n    }\n\n    SetBGM_Off() {\n        GameData.ins().BGM_Mute = true;\n        this.mBgAudioSource.volume = 0;\n        GameData.ins().SaveData_BGM();\n    }\n\n    SetSound_On() {\n        GameData.ins().Sound_Mute = false;\n        GameData.ins().SaveData_Sound();\n    }\n\n    SetSound_Off() {\n        GameData.ins().Sound_Mute = true;\n        GameData.ins().SaveData_Sound();\n    }\n}\n"]}