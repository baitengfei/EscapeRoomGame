{"version":3,"sources":["file:///Users/baitengfei/code/EscapeRoom/EscapeRoomMVP/assets/Scripts/Data/GameData.ts"],"names":["_decorator","sys","SingletonClass","SoundManager","WXAPI","CBaseData","Tools","ccclass","property","GameData","mbCanUseAd","mUserData","BGM_Mute","Sound_Mute","Shake_Mute","Guide_Close","ins","LoadSetData","platform","Platform","WECHAT_GAME","getStorageSync","localStorage","getItem","Instance","InitData","SaveData_BGM","setStorageSync","setItem","SaveData_Sound","SaveData_Shake","SaveData_Guide","setFriend_BestInfo","data","openDataSet","level","specLevel","setStorageValue","name","value","getStorageValue","defaultValue","returnValue","LoadData","userData","JSON","parse","isFirstLoign","mbGetItem_Phone","mbOpenDrawer","mbGetItem_Watch","mbUnlockDoor","mbLockDoorTips","SaveBaseData","mLastSaveTimeStamp","getTimeStamp","stringify"],"mappings":"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","sourcesContent":["//done\n// 游戏数据\nimport SingletonClass from '../Base/SingletonClass';\nimport { SoundManager } from '../Manager/SoundManager';\nimport { WXAPI } from '../SDK/WXAPI';\n\nimport { _decorator, Component, sys } from 'cc';\nimport { CBaseData, EventEnum } from './GameEnum';\nimport { Tools } from '../Tool/Tools';\nimport { CfgUtil } from '../Config/CfgUtil';\nimport { EventManager } from '../Manager/EventManager';\nimport { UIManager, UIType } from '../Manager/UIManager';\nconst { ccclass, property } = _decorator;\n\n@ccclass('GameData')\nexport class GameData extends SingletonClass {\n\n    static ins() {\n        return super.ins() as GameData;\n    }\n\n    // 是否能够调用广告\n    mbCanUseAd:boolean = false;\n\n    // 基础数据\n    mUserData:CBaseData = new CBaseData();\n\n\n    //#region  设置数据\n    BGM_Mute: boolean = false;\n    Sound_Mute: boolean = false;\n    Shake_Mute: boolean = false;\n    Guide_Close:boolean = false;\n\n    LoadSetData() {\n        if (sys.platform === sys.Platform.WECHAT_GAME) {\n            this.BGM_Mute = WXAPI.getStorageSync(\"BGM\") == \"1\";\n            this.Sound_Mute = WXAPI.getStorageSync(\"Sound\") == \"1\";\n            this.Shake_Mute = WXAPI.getStorageSync(\"Shake\") == \"1\";\n            this.Guide_Close = WXAPI.getStorageSync(\"Guide\") == \"1\";\n        }\n        else {\n            this.BGM_Mute = localStorage.getItem(\"BGM\") == \"1\";\n            this.Sound_Mute = localStorage.getItem(\"Sound\") == \"1\";\n            this.Shake_Mute = localStorage.getItem(\"Shake\") == \"1\";\n            this.Guide_Close = localStorage.getItem(\"Guide\") == \"1\";\n        }\n\n        SoundManager.Instance.InitData();\n    }\n\n    SaveData_BGM() {\n        if (sys.platform === sys.Platform.WECHAT_GAME) {\n            WXAPI.setStorageSync(\"BGM\", this.BGM_Mute ? \"1\" : \"0\");\n        }\n        else {\n            localStorage.setItem(\"BGM\", this.BGM_Mute ? \"1\" : \"0\");\n        }\n    }\n\n    SaveData_Sound() {\n        if (sys.platform === sys.Platform.WECHAT_GAME) {\n            WXAPI.setStorageSync(\"Sound\", this.Sound_Mute ? \"1\" : \"0\");\n        }\n        else {\n            localStorage.setItem(\"Sound\", this.Sound_Mute ? \"1\" : \"0\");\n        }\n    }\n\n    SaveData_Shake() {\n        if (sys.platform === sys.Platform.WECHAT_GAME) {\n            WXAPI.setStorageSync(\"Shake\", this.Shake_Mute ? \"1\" : \"0\");\n        }\n        else {\n            localStorage.setItem(\"Shake\", this.Shake_Mute ? \"1\" : \"0\");\n        }\n    }\n\n    SaveData_Guide() {\n        if (sys.platform === sys.Platform.WECHAT_GAME) {\n            WXAPI.setStorageSync(\"Guide\", this.Guide_Close ? \"1\" : \"0\");\n        }\n        else {\n            localStorage.setItem(\"Guide\", this.Guide_Close ? \"1\" : \"0\");\n        }\n    }\n\n    //#endregion\n\n    //设置单人信息(好友排行)\n    setFriend_BestInfo(data) {\n        if (sys.platform !== sys.Platform.WECHAT_GAME) {\n            return;\n        }\n\n        WXAPI.openDataSet('level', \"\" + data.level);\n        WXAPI.openDataSet('specLevel', \"\" + data.specLevel);\n    }\n\n    //#region 本地信息存储\n    setStorageValue(name:string, value:string) {\n        if (sys.platform === sys.Platform.WECHAT_GAME) {\n            WXAPI.setStorageSync(name, value);\n        }\n        else {\n            localStorage.setItem(name, value);\n        }\n    }\n\n    getStorageValue(name:string, defaultValue:any){\n        let returnValue;\n        if (sys.platform === sys.Platform.WECHAT_GAME) {\n            returnValue = WXAPI.getStorageSync(name)\n        }\n        else {\n            returnValue = localStorage.getItem(name)\n        }\n\n        if (returnValue == \"\" || returnValue == null) {\n            returnValue = defaultValue;\n        }\n        return returnValue;\n    }\n\n    //#endregion\n\n    LoadData() {\n        let userData = this.getStorageValue(\"BaseData\", \"\");\n        if (userData != \"\") {\n            this.mUserData = JSON.parse(userData);\n        }\n        else {\n            this.InitData();\n        }\n    }\n\n    InitData() {\n        this.mUserData.isFirstLoign = true;\n        this.mUserData.mbGetItem_Phone = false;\n        this.mUserData.mbOpenDrawer = false;\n        this.mUserData.mbGetItem_Watch = false;\n        this.mUserData.mbUnlockDoor = false;\n        this.mUserData.mbLockDoorTips = false;\n    }\n\n    SaveBaseData() {\n        GameData.ins().mUserData.mLastSaveTimeStamp = Tools.getTimeStamp();\n        this.setStorageValue(\"BaseData\", JSON.stringify(this.mUserData));\n    }\n\n}\n"]}